–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Å–≤–µ—â–µ–Ω–∏—è (Modbus/TCP)

–ù–µ–±–æ–ª—å—à–æ–µ, –Ω–µ –∑–∞–≤–∏—Å—è—â–µ–µ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ Windows-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç —Å–≤–µ—Ç –≤ –∑–∞–¥–∞–Ω–Ω—ã—Ö –∑–æ–Ω–∞—Ö –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –æ–±—â–∞—è—Å—å —Å –ü–õ–ö –ø–æ Modbus/TCP.
–í –∫–æ–º–ø–ª–µ–∫—Ç–µ –µ—Å—Ç—å —ç–º—É–ª—è—Ç–æ—Ä –ü–õ–ö (Modbus slave) –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ ¬´–∂–µ–ª–µ–∑–∞¬ª.

üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

light_scheduler/
‚îú‚îÄ CMakeLists.txt
‚îú‚îÄ config/
‚îÇ  ‚îî‚îÄ config.ini
‚îî‚îÄ src/
   ‚îú‚îÄ app.cpp / app.hpp          # ¬´–°–∫–ª–µ–π–∫–∞¬ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª
   ‚îú‚îÄ interactive.cpp / .hpp     # –ú–∞—Å—Ç–µ—Ä –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (--interactive)
   ‚îú‚îÄ loader.cpp / .hpp          # –†–∞–∑–±–æ—Ä config.ini -> Config/Schedule
   ‚îú‚îÄ ini.cpp / .hpp             # –ü—Ä–æ—Å—Ç–æ–π INI-–ø–∞—Ä—Å–µ—Ä
   ‚îú‚îÄ model.hpp                  # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö Config –∏ Schedule
   ‚îú‚îÄ modbus_tcp.cpp / .hpp      # Modbus/TCP –∫–ª–∏–µ–Ω—Ç –Ω–∞ Winsock (FC1/3/5/6)
   ‚îú‚îÄ scheduler.cpp / .hpp       # –î–≤–∏–∂–æ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è + heartbeat
   ‚îú‚îÄ time_util.cpp / .hpp       # –†–∞–±–æ—Ç–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º/–¥–∞—Ç–∞–º–∏
   ‚îú‚îÄ dummy_plc.cpp              # –≠–º—É–ª—è—Ç–æ—Ä Modbus/TCP slave –¥–ª—è —Ç–µ—Å—Ç–æ–≤
   ‚îî‚îÄ main.cpp                   # –¢–æ–Ω–∫–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç

–ß–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–∑–æ–Ω—ã, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, IP/–ø–æ—Ä—Ç/unit_id –ü–õ–ö).
–í –º–æ–º–µ–Ω—Ç —Å—Ç–∞—Ä—Ç–∞ —Å–æ–±—ã—Ç–∏—è:
–ü–∏—à–µ—Ç coil (FC5) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–æ–Ω—ã –≤ ON, –∞ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –æ–∫–Ω–∞ ‚Äî –≤ OFF.
–£—á–∏—Ç—ã–≤–∞–µ—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ñ–ª–∞–≥ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è remote_enable_coil (–µ—Å–ª–∏ coil=0 ‚Üí —Å–æ–±—ã—Ç–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ).
–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç heartbeat ‚Äî —Å—á—ë—Ç—á–∏–∫ –≤ holding-—Ä–µ–≥–∏—Å—Ç—Ä (FC6).
–ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–∫–Ω–∞, –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω –≤–Ω—É—Ç—Ä–∏ –∏—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.
–ß–∏—Å—Ç—ã–π Modbus/TCP –Ω–∞ Winsock ‚Äî –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.

‚öôÔ∏è –°–±–æ—Ä–∫–∞ (Windows)

–¢—Ä–µ–±—É–µ—Ç—Å—è: Windows, CMake, MSVC (–∏–ª–∏ MinGW-w64).
cmake -B build -S .
cmake --build build --config Release

‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ (2 —Ä–µ–∂–∏–º–∞)
1) –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏)

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ config\config.ini, –∑–∞—Ç–µ–º:
.\build\Release\light_scheduler.exe .\config\config.ini

2) –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (–±—ã—Å—Ç—Ä–∞—è –¥–µ–º–æ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)
.\build\Release\light_scheduler.exe --interactive

–ú–∞—Å—Ç–µ—Ä —Å–ø—Ä–æ—Å–∏—Ç IP/–ø–æ—Ä—Ç/UnitID –ü–õ–ö, –∑–æ–Ω—ã (–∏–º—è ‚Üí offset –∫–∞—Ç—É—à–∫–∏), heartbeat –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è; –ø–æ–∫–∞–∂–µ—Ç —Å–≤–æ–¥–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç.

üìò –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)

–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π:

—É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏–µ–º/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º —Å–≤–µ—Ç–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –∏ —Ä–∞–∑–æ–≤–æ),
–ø–æ Modbus/TCP —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–∞—Ç—É—à–∫–∞–º–∏ –ü–õ–ö,
–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ñ–ª–∞–≥ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞—Ç—É—à–∫–∏,
–ø—É–±–ª–∏–∫—É–µ—Ç heartbeat –≤ holding-—Ä–µ–≥–∏—Å—Ç—Ä –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞,
–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞,
—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.